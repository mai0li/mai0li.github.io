<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8" />

  
  <title>Memcrashed</title>

  
  





  
  <meta name="author" content="Pedro Maioli" />
  <meta name="description" content="Defenseless memcached servers still face the web as they were ever meant to.

" />

  
  
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@oakle" />
    <meta name="twitter:title" content="Memcrashed" />
    <meta name="twitter:description" content="Defenseless memcached servers still face the web as they were ever meant to.

" />
    <meta name="twitter:image" content="https://cdn-images-1.medium.com/max/1600/1*rW7Okvh0F97n7VWCPOnJQw.png" />
  

  
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Memcrashed" />
  <meta property="og:description" content="Defenseless memcached servers still face the web as they were ever meant to.

" />
  <meta property="og:url" content="https://mai0li.github.io/post/memcrashed/" />
  <meta property="og:image" content="https://cdn-images-1.medium.com/max/1600/1*rW7Okvh0F97n7VWCPOnJQw.png" />




<meta name="generator" content="Hugo 0.44" />


<link rel="canonical" href="https://mai0li.github.io/post/memcrashed/" />
<link rel="alternative" href="https://mai0li.github.io/index.xml" title="InnerSpeaker" type="application/atom+xml" />


<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />
<meta name="google-site-verification" content="64WN4sgvTVdE8kim7yi2jGHWxpiVRxktflm9A52WeUw" />
<meta name="msvalidate.01" content="59334F67CF537C0638E739FF1A938E21" />





<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="InnerSpeaker" />
<meta name="msapplication-tooltip" content="InnerSpeaker" />
<meta name='msapplication-navbutton-color' content="#5fbf5e" />
<meta name="msapplication-TileColor" content="#5fbf5e" />
<meta name="msapplication-TileImage" content="/img/tile-image-windows.png" />
<link rel="icon" href="https://mai0li.github.io/img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="https://mai0li.github.io/img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="https://mai0li.github.io/img/favicon-32x32.png" />
<link rel="icon" sizes="192x192" href="https://mai0li.github.io/img/touch-icon-android.png" />
<link rel="apple-touch-icon" href="https://mai0li.github.io/img/touch-icon-apple.png" />
<link rel="mask-icon" href="https://mai0li.github.io/img/safari-pinned-tab.svg" color="#5fbf5e" />



<link rel="stylesheet" href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

<link rel="stylesheet" href="https://mai0li.github.io/css/bundle.ff02473a9a.css" />


  
  <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


<script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


<script src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>


</head>
  <body>
    
    <div class="suspension">
      <a title="Go to top" class="to-top is-hide"><span class="icon icon-up"></span></a>
      
        
      
    </div>
    
    
  <header class="site-header">
  <img class="avatar" src="https://avatars1.githubusercontent.com/u/7331302?s=460&amp;v=4" alt="Avatar">
  
  <h2 class="title">InnerSpeaker</h2>
  
  <p class="subtitle">notes on information security</p>
  <button class="menu-toggle" type="button">
    <span class="icon icon-menu"></span>
  </button>
  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item
            
            
            
              is-active
            ">
            <a href="https://mai0li.github.io/">Home</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="https://github.com/mai0li">Works</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="https://mai0li.github.io/tags/">Tags</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="https://mai0li.github.io/links/">Links</a>
          </li>
      
        <li class="menu-item
            
            
            ">
            <a href="https://mai0li.github.io/about/">About</a>
          </li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list">

      
      <li class="social-item">
        <a href="mailto:opponent%20at%20protonmail%20d0t%20c0m" title="Email"><span class="icon icon-email"></span></a>
      </li>

      
      <li class="social-item">
        <a href="//github.com/mai0li" title="GitHub"><span class="icon icon-github"></span></a>
      </li>

      <li class="social-item">
        <a href="//twitter.com/oakle" title="Twitter"><span class="icon icon-twitter"></span></a>
      </li>

      

      

      

      

      

      <li class="social-item">
        <a href="//medium.com/@oakle" title="Medium"><span class="icon icon-medium"></span></a>
      </li>

      

      

      

      

      

      

      

      

      

      

      

      

      <li class="social-item">
        <a href="https://mai0li.github.io/index.xml"><span class="icon icon-rss" title="RSS"></span></a>
      </li>

    </ul>
  </nav>
</header>

  <section class="main post-detail">
    <header class="post-header">
      <h1 class="post-title">Memcrashed</h1>
      <p class="post-meta">@Pedro Maioli · Jul 19, 2018 · 2 min read</p>
    </header>
    <article class="post-content"><p>Defenseless memcached servers still face the web as they were ever meant to.</p>

<p></p>

<p>DDoS amplification methods are pursued by the bad guys for a long time. Hitting the weakest point of the hosting chain is a way. Leveraging a service widely used in many web-facing servers in order to generate traffic is another.</p>

<p><img src="https://cdn-images-1.medium.com/max/800/1*rW7Okvh0F97n7VWCPOnJQw.png" alt="" /></p>

<p>Source: <a href="https://0kee.360.cn/">0Kee Team</a> @ <a href="http://powerofcommunity.net/2017.htm">POC2017</a></p>

<h4 id="from-memcached-s-wiki-https-github-com-memcached-memcached-wiki-configuringserver-networking">From <a href="https://github.com/memcached/memcached/wiki/ConfiguringServer#networking">memcached&rsquo;s Wiki</a>:</h4>

<blockquote>
<p>By default memcached listens on TCP and UDP ports, both 11211. <code>-l</code> allows you to bind to specific interfaces or IP addresses. Memcached does not spend much, if any, effort in ensuring its defensibility from random internet connections. So you must not expose memcached directly to the internet, or otherwise any untrusted users. Using SASL authentication here helps, but should not be totally trusted.</p>
</blockquote>

<p>By spoofing an IP address in a UDP connection, an attacker can efficiently carry a DDoS attack just by stacking the memcached &ldquo;stats&rdquo; command:</p>

<p><img src="https://cdn-images-1.medium.com/max/800/1*dvSJ8Ed_Uycc0CIWnaMyiA.png" alt="" /></p>

<p>keep the stats\nstats\nstats\nstats going&hellip;</p>

<h4 id="so-how-s-the-real-world-doing">So how&rsquo;s the real world doing?</h4>

<p><a href="https://packetstormsecurity.com/news/28039/Pathetic-Patching-Leaves-Over-70-000-Memcached-Servers-Still-Up-For-Grabs.html">Pathetic Patching Leaves Over 70,000 Memcached Servers Still Up For Grabs ≈ Packet Storm<br />
Information Security Services, News, Files, Tools, Exploits, Advisories and Whitepaperspacketstormsecurity.com</a></p>

<p>Bad.</p>

<h4 id="so-how-s-this-tiny-south-american-country-doing">So how&rsquo;s this tiny South American country doing?</h4>

<p><img src="https://cdn-images-1.medium.com/max/800/1*265QkRiGK0MQ0Zf5u26vNw.png" alt="" /></p>

<p>obligatory Shodan report.</p>

<p>Take another look at the top versions graph.</p>

<p>More than half of the servers (which shouldn&rsquo;t be exposed to the web) run versions outdated and prone to <a href="http://blog.talosintelligence.com/2016/10/memcached-vulnerabilities.html">RCE vulnerabilities reported by Talos in 2016</a>. Which can result in crafted requests to efficiently maximize the amplification factor of the DDoS attack as described in the 0kee report.</p>

<blockquote>
<p>Update memcached.</p>
</blockquote></article>
    <footer class="post-footer">
      
      <ul class="post-tags">
        
          <li><a href="https://mai0li.github.io/tags/general-security"><span class="tag">General-Security</span></a></li>
        
          <li><a href="https://mai0li.github.io/tags/memcached"><span class="tag">Memcached</span></a></li>
        
          <li><a href="https://mai0li.github.io/tags/cybersecurity"><span class="tag">Cybersecurity</span></a></li>
        
          <li><a href="https://mai0li.github.io/tags/infosec"><span class="tag">Infosec</span></a></li>
        
          <li><a href="https://mai0li.github.io/tags/ddos"><span class="tag">DDoS</span></a></li>
        
          <li><a href="https://mai0li.github.io/tags/iot"><span class="tag">IoT</span></a></li>
        
      </ul>
      
      <p class="post-copyright">
        © This post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License，please give source if you wish to quote or reproduce.
      </p>
    </footer>
    
      
    
  </section>
  <footer class="site-footer">
  <p>© 2017-2018 InnerSpeaker</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Nuo</a>.</p>
  
</footer>



<script async src="//cdn.bootcss.com/video.js/6.2.8/alt/video.novtt.min.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>

<script src="https://mai0li.github.io/js/bundle.d1288006cf.js"></script>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-122808963-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>





  </body>
</html>
